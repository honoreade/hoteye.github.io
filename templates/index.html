{% extends "base.html" %}
{% block title %}Home{% endblock %}
{% block content %}
    <div class="feed">
        <h1 class="page-title">Latest Tech Insights</h1>

        {% for post in posts %}
            <article class="post-article">
                {% if post.image_url %}
                    <img class="post-img" src="{{ post.image_url }}" alt="{{ post.title }}">
                {% endif %}

                <div class="post-content">
                    <div class="article-metadata">
                        <span class="author">By {{ post.author.username }}</span>
                        <small class="text-muted">{{ post.date_posted.strftime('%Y-%m-%d') }}</small>
                    </div>

                    <h2 class="article-title"><a href="#">{{ post.title }}</a></h2>

                    {% if post.tags %}
                    <div class="article-tags">
                        {% for tag in post.tags.split(',') %}
                            <span class="tag">#{{ tag.strip() }}</span>
                        {% endfor %}
                    </div>
                    {% endif %}

                    <p class="article-desc">{{ post.content }}</p>

                    {% if post.youtube_url %}
                    <div class="youtube-container">
                        <!-- Convert normal YT links to embed links if necessary, ideally handled in backend or JS, doing simple iframe here assuming embed link or robust handling -->
                        <!-- A simple fix for youtube links is to ensure they are embed links. For this demo, we assume the user might paste an embed link or we do simple replacement in jinja if needed. Let's assume the user is smart or we add a helper. -->
                        <!-- Actually, let's try to handle basic youtube watch links with a simple replace in the template for better UX -->
                        <iframe src="{{ post.youtube_url.replace('watch?v=', 'embed/') }}" frameborder="0" allowfullscreen></iframe>
                    </div>
                    {% endif %}
                </div>
            </article>
        {% else %}
            <div class="content-section">
                <p>No posts found. Be the first to <a href="{{ url_for('dashboard') }}" style="color: var(--accent-color)">create one!</a></p>
            </div>
        {% endfor %}
    </div>
{% endblock %}